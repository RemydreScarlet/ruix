# Ruix Kernel

Ruixは、Rustで書かれた安定したマイクロカーネルで、POSIX準拠を目指しています。このプロジェクトは初期段階で、現在VGAテキスト出力、Global Descriptor Table (GDT)のセットアップ、割り込み処理などの基本的なカーネル機能を実装しています。

## 目標

Ruixの主な目標は、堅牢で安全なPOSIX準拠のマイクロカーネルをRustで作成することです。
マイクロカーネルは、カーネルの責任を最小限に抑え、重要なサービスのみをカーネル空間で実行し、他のタスクをユーザースペースプロセスに委任することを目指します。

## 現在の機能

- **VGAバッファ**: VGAディスプレイ用のテキストベース出力システムを実装しており、カラーサポートと基本的な印刷マクロ（`print!` と `println!`）を含みます。
- **Global Descriptor Table (GDT)**: メモリセグメンテーションのためのGDTをセットアップし、割り込み処理のためのTask State Segment (TSS)を含みます。
- **割り込み処理**: Interrupt Descriptor Table (IDT)を初期化し、ブレークポイントとダブルフォルトのハンドラを設定します。
- **パニック処理**: パニック情報を画面に印刷するカスタムパニックハンドラ。

## プロジェクト構造

- `src/main.rs`: カーネルのエントリーポイント（`_start` 関数）。
- `src/lib.rs`: カーネルの公開APIを公開し、コアコンポーネントを初期化するライブラリモジュール。
- `src/vga_buffer.rs`: 画面出力のためのVGAテキストバッファの実装。
- `src/gdt.rs`: Global Descriptor TableとTask State Segmentのセットアップ。
- `src/interrupts.rs`: Interrupt Descriptor Tableと例外ハンドラ。
- `Cargo.toml`: プロジェクト設定と依存関係。
- `x86_64-Ruix.json`: x86_64ベアメタル用のカスタムターゲット仕様。

## 依存関係

- `bootloader`: カーネルのブート用。
- `volatile`: 安全な揮発性メモリアクセス用。
- `spin`: スピンロックベースの同期プリミティブ。
- `x86_64`: 低レベルx86_64アーキテクチャサポート。
- `lazy_static`: 遅延静的初期化。

## ビルドと実行

### 前提条件

- Rust（一部の機能でnightlyツールチェーンが必要）
- ブート可能イメージ作成用の`bootimage`ツール: `cargo install bootimage`

### ビルド

カーネルをビルドするには：

```bash
cargo build --target x86_64-Ruix.json
```

ブート可能イメージを作成するには：

```bash
cargo bootimage
```

### 実行
手動でQEMUを使用：

```bash
qemu-system-x86_64 -drive format=raw,file=target/x86_64-Ruix/debug/bootimage-Ruix.bin
```

## テスト

現在、カーネルにはパニック処理を示すためにスタックオーバーフローを引き起こす簡単なテストが含まれています。これにより、パニック情報が画面に印刷されます。

## 貢献

貢献を歓迎します！ 問題の報告、機能リクエスト、プルリクエストを自由に提出してください。このプロジェクトは教育的なもので実験的なので、カーネル設計と実装に関する議論を歓迎します。

## ライセンス

このプロジェクトはMITライセンスの下でライセンスされています。詳細はLICENSEファイルを参照してください。

## 謝辞

このプロジェクトは、さまざまなOS開発チュートリアルとRustコミュニティにインスパイアされています。`x86_64`クレートとブートローダー実装の作者に特別な感謝を。
